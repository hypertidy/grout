<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Create Raster Tiles • grout</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Create Raster Tiles">
<meta property="og:description" content="Create raster tiles abstractly. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">grout</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.2.9006</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hypertidy/grout/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div class="section level1">
<div class="page-header"><h1 id="grout">grout<a class="anchor" aria-label="anchor" href="#grout"></a>
</h1></div>
<p>Abstract tiling schemes.</p>
<p>Given a grid, impose a tiling scheme. The dangle is overlap the tiles impose (in pixels).</p>
<p>We use the term “block” to refer to the size of each tile in pixels.</p>
<p>We use the simplest specification of a <em>raster grid</em>, which is six numbers: <em>dimension</em> <code>c(ncol, nrow)</code> and <em>extent</em> <code>c(xmin, xmax, ymin, ymax)</code>.</p>
<p>Consider a raster 16 x 12, with 4 x 4 tiling there is no overlap.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hypertidy/grout" class="external-link">grout</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/grout.html">grout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>, extent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">0</span>, <span class="fl">12</span><span class="op">)</span>, blocksize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4L</span>, <span class="fl">4L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;           tiles: 1, 1 (x * y = 1)</span></span>
<span><span class="co">#&gt;           block: 4, 4 </span></span>
<span><span class="co">#&gt;          dangle: 0, 0 </span></span>
<span><span class="co">#&gt; tile resolution: 16, 12 </span></span>
<span><span class="co">#&gt;     tile extent: 0, 16, 0, 12 (xmin,xmax,ymin,ymax)</span></span>
<span><span class="co">#&gt;           grain: 16, 12 (4 : x, 4 : y)</span></span></code></pre></div>
<p>But, if our raster has an dimension that doesn’t divide neatly into the block size, then there is some tile overlap. This should work for any raster dimension and any arbitrary tile size.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/grout.html">grout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">13</span><span class="op">)</span>, extent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span>, <span class="fl">0</span>, <span class="fl">13</span><span class="op">)</span>, blocksize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4L</span>, <span class="fl">4L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;           tiles: 4, 4 (x * y = 16)</span></span>
<span><span class="co">#&gt;           block: 4, 4 </span></span>
<span><span class="co">#&gt;          dangle: 1, 3 </span></span>
<span><span class="co">#&gt; tile resolution: 4, 4 </span></span>
<span><span class="co">#&gt;     tile extent: 0, 16, -3, 13 (xmin,xmax,ymin,ymax)</span></span>
<span><span class="co">#&gt;           grain: 4, 4 (4 : x, 4 : y)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/grout.html">grout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">44</span>, <span class="fl">30</span><span class="op">)</span>, blocksize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;           tiles: 3, 4 (x * y = 12)</span></span>
<span><span class="co">#&gt;           block: 12, 12 </span></span>
<span><span class="co">#&gt;          dangle: 4, 6 </span></span>
<span><span class="co">#&gt; tile resolution: 12, 12 </span></span>
<span><span class="co">#&gt;     tile extent: 0, 48, -6, 30 (xmin,xmax,ymin,ymax)</span></span>
<span><span class="co">#&gt;           grain: 12, 12 (12 : x, 12 : y)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t1</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-grid-1.png"><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="op">(</span><span class="va">t2</span> <span class="op">&lt;-</span> <span class="fu">grout</span><span class="fu">:::</span><span class="fu">.groutfrom</span><span class="op">(</span><span class="va">volcano</span>, blocksize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">16</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;           tiles: 4, 8 (x * y = 32)</span></span>
<span><span class="co">#&gt;           block: 12, 16 </span></span>
<span><span class="co">#&gt;          dangle: 9, 3 </span></span>
<span><span class="co">#&gt; tile resolution: 12, 16 </span></span>
<span><span class="co">#&gt;     tile extent: 0, 96, -3, 61 (xmin,xmax,ymin,ymax)</span></span>
<span><span class="co">#&gt;           grain: 12, 16 (12 : x, 16 : y)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t2</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-grid-2.png"><!-- --></p>
<p>We can generate a table of offset indexes, for use in reading from GDAL (say).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/tile_index.html">tile_index</a></span><span class="op">(</span><span class="va">t2</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 32 × 9</span></span>
<span><span class="co">#&gt;     tile offset_x offset_y  ncol  nrow  xmin  xmax  ymin  ymax</span></span>
<span><span class="co">#&gt;    &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1     1        0        0    12    16     0    12    45    61</span></span>
<span><span class="co">#&gt;  2     2       12        0    12    16    12    24    45    61</span></span>
<span><span class="co">#&gt;  3     3       24        0    12    16    24    36    45    61</span></span>
<span><span class="co">#&gt;  4     4       36        0    12    16    36    48    45    61</span></span>
<span><span class="co">#&gt;  5     5       48        0    12    16    48    60    45    61</span></span>
<span><span class="co">#&gt;  6     6       60        0    12    16    60    72    45    61</span></span>
<span><span class="co">#&gt;  7     7       72        0    12    16    72    84    45    61</span></span>
<span><span class="co">#&gt;  8     8       84        0     3    16    84    87    45    61</span></span>
<span><span class="co">#&gt;  9     9        0       16    12    16     0    12    29    45</span></span>
<span><span class="co">#&gt; 10    10       12       16    12    16    12    24    29    45</span></span>
<span><span class="co">#&gt; # … with 22 more rows</span></span></code></pre></div>
<p>See below for generating <code>wk::rct</code> objects from the tile index.</p>
<p>Or just plot the scheme.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t1</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-plot-1.png"><!-- --></p>
<div class="section level2">
<h2 id="what-for">What for?<a class="anchor" aria-label="anchor" href="#what-for"></a>
</h2>
<p>This gives us fine control over the exact nature of the data we can read from large sources.</p>
<p>Consider this large image online:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://services.ga.gov.au/gis/rest/services/Topographic_Base_Map/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=Topographic_Base_Map,tilematrixset=default028mm"</span></span>
<span><span class="va">dsn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"WMTS:%s,layer=Topographic_Base_Map,tilematrixset=default028mm"</span>, <span class="va">url</span><span class="op">)</span></span>
<span><span class="va">info</span> <span class="op">&lt;-</span> <span class="fu">vapour</span><span class="fu">::</span><span class="fu">vapour_raster_info</span><span class="op">(</span><span class="va">dsn</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">overviews</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">info</span><span class="op">$</span><span class="va">overviews</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;            [,1]      [,2]</span></span>
<span><span class="co">#&gt;  [1,] 205851559 165517805</span></span>
<span><span class="co">#&gt;  [2,] 102925779  82758902</span></span>
<span><span class="co">#&gt;  [3,]  51462890  41379451</span></span>
<span><span class="co">#&gt;  [4,]  25731445  20689726</span></span>
<span><span class="co">#&gt;  [5,]  12865722  10344863</span></span>
<span><span class="co">#&gt;  [6,]   6432861   5172431</span></span>
<span><span class="co">#&gt;  [7,]   3216431   2586216</span></span>
<span><span class="co">#&gt;  [8,]   1608215   1293108</span></span>
<span><span class="co">#&gt;  [9,]    804108    646554</span></span>
<span><span class="co">#&gt; [10,]    402054    323277</span></span>
<span><span class="co">#&gt; [11,]    201027    161638</span></span>
<span><span class="co">#&gt; [12,]    100513     80819</span></span>
<span><span class="co">#&gt; [13,]     50257     40410</span></span>
<span><span class="co">#&gt; [14,]     25128     20205</span></span>
<span><span class="co">#&gt; [15,]     12564     10102</span></span>
<span><span class="co">#&gt; [16,]      6282      5051</span></span>
<span><span class="co">#&gt; [17,]      3141      2526</span></span>
<span><span class="co">#&gt; [18,]      1571      1263</span></span>
<span><span class="co">#&gt; [19,]       785       631</span></span>
<span><span class="co">#&gt; [20,]       393       316</span></span>
<span><span class="co">#&gt; [21,]       196       158</span></span>
<span></span>
<span><span class="co">## level 16 is a reasonable size to experiment with</span></span>
<span><span class="va">dm</span> <span class="op">&lt;-</span> <span class="va">overviews</span><span class="op">[</span><span class="fl">16L</span>, , drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">]</span></span></code></pre></div>
<p>The raster readers in terra or stars gives us an object that can be operated with, if we crop it only those cell values are read - but we have no idea about the underlying tiling of the data source itself.</p>
<p>With GDAL more directly we can find the underlying tile structure, which tells us about the 256x256 tiling scheme.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">info</span><span class="op">[</span><span class="st">"block"</span><span class="op">]</span></span>
<span><span class="co">#&gt; $block</span></span>
<span><span class="co">#&gt; [1] 128 128</span></span></code></pre></div>
<p>Now with grout we can actually generate the tile scheme and work with it, let’s say we know that we want a region near tile number 1583. Using the information about the tiles we can find the adjacent tile cell numbers, then use that to crop the original source.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">tile0</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/grout.html">grout</a></span><span class="op">(</span><span class="va">dm</span>, <span class="va">info</span><span class="op">$</span><span class="va">extent</span>, blocksize <span class="op">=</span> <span class="va">info</span><span class="op">$</span><span class="va">block</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;           tiles: 40, 50 (x * y = 2000)</span></span>
<span><span class="co">#&gt;           block: 128, 128 </span></span>
<span><span class="co">#&gt;          dangle: 118, 69 </span></span>
<span><span class="co">#&gt; tile resolution: 156545.3, 156549.3 </span></span>
<span><span class="co">#&gt;     tile extent: 11148027, 18975292, -6527909, -265936.2 (xmin,xmax,ymin,ymax)</span></span>
<span><span class="co">#&gt;           grain: 156545.3, 156549.3 (128 : x, 128 : y)</span></span>
<span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tile_index.html">tile_index</a></span><span class="op">(</span><span class="va">tile0</span><span class="op">)</span></span>
<span><span class="va">polys</span> <span class="op">&lt;-</span> <span class="fu">wk</span><span class="fu">::</span><span class="fu">rct</span><span class="op">(</span><span class="va">index</span><span class="op">$</span><span class="va">xmin</span>, <span class="va">index</span><span class="op">$</span><span class="va">ymin</span>, <span class="va">index</span><span class="op">$</span><span class="va">xmax</span>, <span class="va">index</span><span class="op">$</span><span class="va">ymax</span><span class="op">)</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fl">1584</span></span>
<span><span class="va">row</span> <span class="op">&lt;-</span> <span class="fu">vaster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vaster/man/cells.html" class="external-link">row_from_cell</a></span><span class="op">(</span><span class="op">(</span><span class="va">dm</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">128</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, <span class="va">cl</span><span class="op">)</span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu">vaster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vaster/man/cells.html" class="external-link">col_from_cell</a></span><span class="op">(</span><span class="op">(</span><span class="va">dm</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">128</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, <span class="va">cl</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rowcol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="va">row</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="va">col</span><span class="op">)</span></span>
<span><span class="co">## adjacent (this really needs some work between grout and vaster to make it obvious and easy)</span></span>
<span><span class="va">cells</span> <span class="op">&lt;-</span> <span class="fu">vaster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vaster/man/cells.html" class="external-link">cell_from_row_col</a></span><span class="op">(</span><span class="op">(</span><span class="va">dm</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">128</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, <span class="va">rowcol</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">rowcol</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#cells &lt;- raster::adjacent(tile0$tileraster, 6500, include = TRUE, directions = 8)[, "to"]</span></span>
<span><span class="va">exs</span> <span class="op">&lt;-</span> <span class="va">index</span><span class="op">[</span><span class="va">cells</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"xmin"</span>, <span class="st">"xmax"</span>, <span class="st">"ymin"</span>, <span class="st">"ymax"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">ex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">exs</span><span class="op">$</span><span class="va">xmin</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">exs</span><span class="op">$</span><span class="va">xmax</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">exs</span><span class="op">$</span><span class="va">ymin</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">exs</span><span class="op">$</span><span class="va">ymax</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">im</span> <span class="op">&lt;-</span> <span class="fu">whatarelief</span><span class="fu">::</span><span class="fu">imagery</span><span class="op">(</span>source <span class="op">=</span> <span class="va">dsn</span>, extent <span class="op">=</span> <span class="va">ex</span>, dimension <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">128</span>, <span class="fl">128</span><span class="op">)</span> <span class="op">*</span> <span class="fl">3</span>, projection <span class="op">=</span> <span class="va">info</span><span class="op">$</span><span class="va">projection</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">polys</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">polys</span><span class="op">)</span> <span class="op">==</span> <span class="va">cl</span><span class="op">)</span></span>
<span><span class="fu">ximage</span><span class="fu">::</span><span class="fu">ximage</span><span class="op">(</span><span class="va">im</span>, extent <span class="op">=</span> <span class="va">ex</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-scheme-1.png"><!-- --></p>
<p>Finally, we have an in-memory raster of the original source data for very specific tiles.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ximage</span><span class="fu">::</span><span class="fu">ximage</span><span class="op">(</span><span class="va">im</span>, extent <span class="op">=</span> <span class="va">ex</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">polys</span><span class="op">[</span><span class="va">cells</span><span class="op">]</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fu">wk</span><span class="fu">::</span><span class="fu">wk_coords</span><span class="op">(</span><span class="fu">geos</span><span class="fu">::</span><span class="fu">geos_centroid</span><span class="op">(</span><span class="va">polys</span><span class="op">[</span><span class="va">cells</span> <span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, lab <span class="op">=</span> <span class="va">cells</span>, col <span class="op">=</span> <span class="st">"firebrick"</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-specific-1.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="todo">TODO<a class="anchor" aria-label="anchor" href="#todo"></a>
</h2>
<ul class="task-list">
<li>
<input type="checkbox" disabled checked>remove need for using sp polygons</li>
<li>
<input type="checkbox" disabled>set tools for cropping that use the index, not spatial extent (i.e. extent(x, x0, x1, y0, y1))</li>
<li>
<input type="checkbox" disabled checked>remove use of sp and raster internally for the data structures, just store the information about the grid/s</li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the grout project is released with a <a href="https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html" class="external-link">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/hypertidy/grout/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/hypertidy/grout/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing grout</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Michael D. Sumner <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.tidyverse.org/lifecycle/#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://CRAN.R-project.org/package=grout" class="external-link"><img src="https://www.r-pkg.org/badges/version/grout" alt="CRAN status"></a></li>
<li><a href="https://github.com/hypertidy/grout/actions" class="external-link"><img src="https://github.com/hypertidy/grout/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://github.com/hypertidy/grout/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/hypertidy/grout/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Michael D. Sumner.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
